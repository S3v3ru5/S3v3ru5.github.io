{{- define "main" }}

<div class="audits-page">

<header class="page-header">
  {{- partial "breadcrumbs.html" . }}
  <h1>{{ .Title }}</h1>
  {{- if .Description }}
  <div class="post-description">
    {{ .Description | markdownify }}
  </div>
  {{- end }}
</header>

{{- if .Content }}
<div class="page-content">
  {{ .Content }}
</div>
{{- end }}

{{- if .Site.Data.audits }}

{{- if .Site.Data.audits.audits }}
<h2>Audits (Public)</h2>
<table>
  <thead>
    <tr>
      <th>Protocol</th>
      <th>Chain</th>
      <th>Type</th>
      <th>Date</th>
      <th>Report</th>
    </tr>
  </thead>
  <tbody>
    {{- range .Site.Data.audits.audits }}
    <tr>
      <td><a href="{{ .protocol_url }}" target="_blank" rel="noopener">{{ .protocol }}</a></td>
      <td>
        <div class="tag-container">
          {{- $chains := split .chain ", " }}
          {{- range $chains }}
          {{- $trimmed := trim . " " }}
          {{- $hash := 0 }}
          {{- range $i, $char := (split (lower $trimmed) "") }}
            {{- $hash = add $hash (mul (add $i 1) (printf "%c" $char | len)) }}
          {{- end }}
          {{- $colorIndex := mod $hash 12 }}
          <span class="tag" data-color="{{ $colorIndex }}">{{ $trimmed }}</span>
          {{- end }}
        </div>
      </td>
      <td>
        <div class="tag-container">
          {{- $types := split .type ", " }}
          {{- range $types }}
          {{- $trimmed := trim . " " }}
          {{- $hash := 0 }}
          {{- range $i, $char := (split (lower $trimmed) "") }}
            {{- $hash = add $hash (mul (add $i 1) (printf "%c" $char | len)) }}
          {{- end }}
          {{- $colorIndex := mod $hash 12 }}
          <span class="tag" data-color="{{ $colorIndex }}">{{ $trimmed }}</span>
          {{- end }}
        </div>
      </td>
      <td>{{ .date }}</td>
      <td>
        {{- if .report }}
        <a href="{{ .report }}" target="_blank" rel="noopener" title="View Report">
          <svg class="report-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M10 2v6.5a.5.5 0 0 0 .5.5h6.5"/>
            <path d="M4 6.5V20a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.5L14 2H6a2 2 0 0 0-2 2z"/>
            <path d="M8 13h8"/>
            <path d="M8 17h8"/>
          </svg>
        </a>
        {{- else }}
        -
        {{- end }}
      </td>
    </tr>
    {{- end }}
  </tbody>
</table>
{{- end }}

{{- if .Site.Data.audits.contests }}
<h2>Contests</h2>
<table>
  <thead>
    <tr>
      <th>Protocol</th>
      <th>Platform</th>
      <th>Type</th>
      <th>Date</th>
      <th>Rank</th>
    </tr>
  </thead>
  <tbody>
    {{- range .Site.Data.audits.contests }}
    <tr>
      <td><a href="{{ .protocol_url }}" target="_blank" rel="noopener">{{ .protocol }}</a></td>
      <td>{{ .platform }}</td>
      <td>
        <div class="tag-container">
          {{- $types := split .type ", " }}
          {{- range $types }}
          {{- $trimmed := trim . " " }}
          {{- $hash := 0 }}
          {{- range $i, $char := (split (lower $trimmed) "") }}
            {{- $hash = add $hash (mul (add $i 1) (printf "%c" $char | len)) }}
          {{- end }}
          {{- $colorIndex := mod $hash 12 }}
          <span class="tag" data-color="{{ $colorIndex }}">{{ $trimmed }}</span>
          {{- end }}
        </div>
      </td>
      <td>{{ .date }}</td>
      <td>
        {{- if and .leaderboard (ne .rank "-") }}
        <a href="{{ .leaderboard }}" target="_blank" rel="noopener">{{ .rank }}</a>
        {{- else }}
        {{ .rank }}
        {{- end }}
      </td>
    </tr>
    {{- end }}
  </tbody>
</table>
{{- end }}

{{- end }}

</div>

{{- end }}{{- /* end main */ -}}